<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Create Request</title>
  <script>
    // Hàm hiển thị hoặc ẩn phần tử khi thay đổi loại yêu cầu
    function toggleFields() {
      var requestType = document.getElementById("requestType").value;

      // Hiển thị bảng nhân viên đủ điều kiện tăng lương hoặc thăng chức
      if (requestType === "Thăng chức") {
        document.getElementById("promotionTable").style.display = "block";  // Hiển thị bảng thăng chức
        document.getElementById("salaryIncreaseTable").style.display = "none";  // Ẩn bảng tăng lương
        document.getElementById("addFinancialPolicyBtn").style.display = "none";  // Ẩn nút Add Financial Policy
        document.getElementById("updatePromotionPositionBtn").style.display = "block";  // Hiển thị nút Update Promotion Position
        document.getElementById("promotionEmployeesTable").style.display = "none";  // Ẩn bảng Selected Employees for Promotion khi chọn thăng chức
        document.getElementById("salaryIncreaseEmployeesTable").style.display = "none";  // Ẩn bảng Selected Employees for Salary Increase khi chọn thăng chức
      } else if (requestType === "Tăng lương") {
        document.getElementById("salaryIncreaseTable").style.display = "block";  // Hiển thị bảng tăng lương
        document.getElementById("promotionTable").style.display = "none";  // Ẩn bảng thăng chức
        document.getElementById("addFinancialPolicyBtn").style.display = "block";  // Hiển thị nút Add Financial Policy
        document.getElementById("updatePromotionPositionBtn").style.display = "none";  // Ẩn nút Update Promotion Position
        document.getElementById("promotionEmployeesTable").style.display = "none";  // Ẩn bảng Selected Employees for Promotion khi chọn tăng lương
        document.getElementById("salaryIncreaseEmployeesTable").style.display = "block";  // Hiển thị bảng Selected Employees for Salary Increase khi chọn tăng lương
      }
    }

  </script>
  <style>
    /* Flexbox cho phần tử */
    .container {
      display: flex;
      gap: 20px; /* Khoảng cách giữa các phần tử */
      padding: 20px;
    }

    .form-section {
      width: 40%; /* Form chiếm 2/5 chiều rộng */
      border: 1px solid #ccc;
      background-color: #f9f9f9;
      padding: 20px;
    }

    .table-section {
      width: 60%; /* Table chiếm 3/5 chiều rộng */
      border: 1px solid #ccc;
      background-color: #f9f9f9;
      padding: 20px;
      display: flex;
      flex-direction: column; /* Xếp các phần tử theo chiều dọc */
      gap: 20px; /* Khoảng cách giữa các phần tử trong table-section */
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th, td {
      padding: 10px;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }

    th {
      background-color: #f4f4f4;
    }

    button {
      padding: 10px 15px;
      background-color: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
    }

    button:hover {
      background-color: #45a049;
    }

    .back-btn {
      background-color: #f44336;
      color: white;
      padding: 10px 15px;
      border: none;
      cursor: pointer;
    }

    .back-btn:hover {
      background-color: #e53935;
    }

    /* Responsive: Điều chỉnh cho màn hình nhỏ hơn */
    @media (max-width: 768px) {
      .container {
        flex-direction: column; /* Xếp phần tử theo chiều dọc khi màn hình nhỏ */
        padding: 10px; /* Giảm khoảng cách padding */
      }

      .form-section, .table-section {
        width: 100%; /* Chiều rộng 100% cho màn hình nhỏ */
      }

      button {
        padding: 8px 12px; /* Giảm kích thước nút */
      }

      table {
        font-size: 14px; /* Giảm kích thước font cho bảng */
      }
    }
  </style>
</head>
<body>
<h1>Create Salary Increase or Promotion Request</h1>

<div class="container">
  <!-- Form Section -->
  <div class="form-section">
    <form action="/request/create" method="post">
      <div>
        <label for="department">Department:</label>
        <select id="department" name="departmentId">
          <option value="">Chọn phòng ban</option>
          <option th:each="d : ${departmentList}" th:value="${d.departmentId}" th:text="${d.departmentName}">
          </option>
        </select>
      </div>

      <div>
        <label for="requestType">Request Type:</label>
        <select id="requestType" name="requestType" onchange="toggleFields()">
          <option value="">Chọn loại yêu cầu</option>
          <option value="Tăng lương">Salary Increase</option>
          <option value="Thăng chức">Promotion</option>
        </select>
      </div>

      <div>
        <label for="employeeName">Employee Name:</label>
        <input type="text" id="employeeName" name="employeeName" />
      </div>

      <div id="salaryIncreasePercentage" style="display:none;">
        <label for="salaryIncreasePercentageInput">Salary Increase Percentage (%):</label>
        <input type="number" id="salaryIncreasePercentageInput" name="salaryIncreasePercentage" step="0.1" min="0" />
      </div>

      <button type="submit">Submit Request</button>
    </form>
  </div>

  <!-- Table Section for Employees Eligible for Salary Increase and Selected Employees -->
  <div class="table-section">
    <!-- Table for displaying employees eligible for salary increase -->
    <div id="salaryIncreaseTable">
      <h2>Employees Eligible for Salary Increase</h2>
      <table id="employeeTable" border="1">
        <thead>
        <tr>
          <th>STT</th>
          <th>Họ tên</th>
          <th>MS nhân viên</th>
          <th>Vị trí</th>
          <th>Mức lương cũ</th>
          <th>Mức lương mới</th>
          <th>Ngày bắt đầu</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="request : ${requestDTO}">
          <td th:text="${request.requestId}"></td> <!-- STT -->
          <td th:text="${request.fullName}"></td> <!-- Full Name -->
          <td th:text="${request.employeeCode}"></td> <!-- Employee Code -->
          <td th:text="${request.positionName}"></td> <!-- Position Name -->
          <td th:text="${T(java.lang.String).format('%,.0f', request.oldBaseSalary) + ' VND'}"></td> <!-- Base Salary -->
          <td th:text="${T(java.lang.String).format('%,.0f', request.newBaseSalary) + ' VND'}"></td> <!-- Base Salary -->
          <td th:text="${request.startedAt}"></td> <!-- Started At -->
        </tr>
        </tbody>
      </table>
    </div>

  </div>

</div>

<!-- Back button -->
<button class="back-btn" onclick="window.location.href='/request'">Back</button>
<script>
  // Hàm hiển thị hoặc ẩn phần tử khi thay đổi loại yêu cầu
  function toggleFields() {
    var requestType = document.getElementById("requestType").value;

    // Hiển thị trường nhập % lương khi chọn "Tăng lương", ẩn khi chọn "Thăng chức"
    if (requestType === "Tăng lương") {
      document.getElementById("salaryIncreasePercentage").style.display = "block";
    } else {
      document.getElementById("salaryIncreasePercentage").style.display = "none";
    }
  }
</script>
</body>
</html>
